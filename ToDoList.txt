#!ToDoList.txt

***** Features to Add *****
* Update ShowOneDevice if state changes (eg switched On, power reading), but not if editing name...  Perhaps have separate page to edit name?
* Energy table in database (updated hourly, I think)
* Rationalise php pages to put all database access into one file (functions.php).  Use global
* Daily synopsis to use HTML email to show UpTime & snapshot of devices page, plus last day's activity log.  Customise and improve synopsis, so that we can have different synopses daily, weekly or monthly...
* Auto-start network ("AT+EN") if ATN shows none available at start up
* Multiple device ZigBee endpoints?
 
***** Features to Test *****
* (Add "alter table Devices add column powerReading INTEGER;" via SQL)
* Groups aren't updating via web (at home, but work fine at work.  Hmm.)

# *** Burglar alarm? ***  Probably best done in Python
# if keyfob==arm do Set AlarmState=StartArming
# if AlarmState==StartArming do Set AlarmTimeout=30, Set AlarmState=Arming
# if AlarmState==Arming do repeat play ArmingAlarm.mp3
# if AlarmState==DoneArming do stop play, Set AlarmState=Armed
# if ExternalDoors==opened and Alarm==DoneArming do Set AlarmState=Disarm, email Door open - Disarming
# if InternalPirs==active and Alarm==Armed do Set AlarmState=Elevate
# if InternalPirs==active and Alarm==Elevated do Set AlarmState=Activate
# if ExternalDoors==opened and Alarm==Armed do Set AlarmState=Elevate
# if ExternalDoors==opened and Alarm==Elevated do Set AlarmState=Activate
# if Alarm==Elevate do Set AlarmTimeout=60, Set AlarmState=Elevated
# if Alarm==Activated do play IntruderAlert.mp3
# if Alarm==Activated do email Intruder Alert!
# if keyfob==disarm do Set AlarmState=Disarm

# *** Activity Pretence ***   Probably best done in Python
# if Alarm==Armed and sunset<time<23:59 do SwitchOn SpikeyLampPlug
# if time==00:30 and Alarm==Armed do SwitchOff SpikeyLampPlug
# if InternalPirs==unoccupied and 0:00<time<sunset and HallLight_OnOff==off and rand(30)==0 do SwitchOn HallLight for 300

Bugs
* Reaction time to respond to events increases with uptime, ever since adding queued messages per device - maybe fixed?
* Occasionally stalls!  But then recovers as if nothing had happened.  Suspect stalled messages for other devices - maybe fixed?
* Still get stupid serial errors!!!  But only when headless...

